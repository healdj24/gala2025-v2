<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Gala 2025</title>
  <style>
    @font-face {
      font-family: 'Nagbuloe';
      src: url('./fonts/Nagbuloe-Regular.otf') format('opentype');
      font-weight: normal;
      font-style: normal;
    }

    @font-face {
      font-family: 'Nagbuloe';
      src: url('./fonts/Nagbuloe-Bold.otf') format('opentype');
      font-weight: bold;
      font-style: normal;
    }

    @font-face {
      font-family: 'Nagbuloe Outline';
      src: url('./fonts/Nagbuloe-Outline.otf') format('opentype');
      font-weight: normal;
      font-style: normal;
    }

    @font-face {
      font-family: 'Nagbuloe Thin';
      src: url('./fonts/Nagbuloe-Thin.otf') format('opentype');
      font-weight: 100;
      font-style: normal;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      overflow-x: hidden;
    }

    /* White section at top - scrolls up like peeling layer */
    .white-section {
      position: relative;
      height: 100vh;
      background: #ffffff;
      z-index: 20;
    }

    /* Orange section below - fixed underneath */
    .orange-section {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      min-height: 100vh;
      background: #ff6b35;
      z-index: 1;
    }

    /* Third orange screen - slides up to cover text */
    .third-section {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 100vh;
      background: #ff6b35;
      z-index: 500;
      transform: translateY(100%);
      will-change: transform;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 4rem;
    }

    /* Third section content layout */
    .third-content {
      display: flex;
      width: 100%;
      max-width: 1400px;
      gap: 4rem;
      align-items: center;
    }

    .third-left {
      flex: 1;
      color: #ffffff;
      font-family: 'Nagbuloe', serif;
      font-size: 0.61rem; /* Mobile: 30% bigger than orange blurb (0.47 * 1.3) */
      line-height: 1.6;
    }

    .third-right {
      flex: 1;
      color: #ffffff;
      font-family: 'Nagbuloe', serif;
      font-weight: bold;
      font-size: 0.79rem; /* Mobile: 30% bigger than third-left (0.61 * 1.3) */
      text-align: center;
    }

    /* Desktop adjustments */
    @media (min-width: 768px) {
      .third-left {
        font-size: 0.72rem; /* Desktop: 50% bigger than current (0.48 * 1.5) */
      }

      .third-right {
        font-size: 1.46rem; /* Desktop: 30% bigger than current (1.12 * 1.3) */
      }
    }

    /* Spacer to allow scrolling - extended for smooth third section reveal */
    .scroll-spacer {
      position: relative;
      height: 300vh;
      z-index: 0;
    }

    /* Fixed hero content */
    .hero {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      z-index: 100;
      pointer-events: none;
    }

    .small-text {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', sans-serif;
      font-size: 0.75rem;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: #000;
      margin-bottom: 1rem;
      font-weight: 400;
      transition: color 0.3s ease;
    }

    .small-text.on-orange {
      color: #ffffff;
    }

    .main-title {
      font-family: 'Nagbuloe', serif;
      font-size: clamp(4rem, 15vw, 12rem);
      font-weight: normal;
      color: #000;
      margin: 0;
      line-height: 0.9;
      letter-spacing: -0.02em;
      font-variant-ligatures: none;
      font-kerning: none;
      transition: color 0.3s ease;
      display: inline-block;
      white-space: nowrap;
    }

    .main-title.on-orange {
      color: #ffffff;
    }

    /* Word grouping for "the" and "gala" */
    .word {
      display: inline-block;
      white-space: nowrap;
    }

    .word span {
      font-family: 'Nagbuloe', serif;
      font-weight: bold;
      display: inline-block;
    }

    .word span.outline {
      font-family: 'Nagbuloe Outline', serif;
      font-weight: normal;
    }

    /* Orange section blurb */
    .orange-blurb {
      position: absolute;
      top: 61%; /* Mobile: 12% higher (73% - 12%) */
      left: 50%;
      transform: translateX(-50%);
      font-family: 'Nagbuloe', serif;
      font-weight: bold;
      font-size: 0.94rem; /* Mobile: doubled from 0.47rem */
      color: #000; /* Start as black */
      text-align: center;
      width: 92%; /* Mobile: force container to be wide, close to screen edges */
      line-height: 1.3;
      z-index: 5;
      transition: color 0.3s ease;
      padding: 0 1rem; /* Add some padding so text doesn't touch edges */
    }

    .orange-blurb.on-orange {
      color: #ffffff; /* Changes to white when orange section touches top */
    }

    /* Desktop size for orange blurb */
    @media (min-width: 768px) {
      .orange-blurb {
        top: 73%; /* Desktop: stays at original position */
        font-size: 1.4rem; /* Keep desktop size */
        width: auto; /* Desktop: let it size naturally */
        max-width: 80%; /* Desktop: cap at 80% */
      }
    }

    /* Play button styling */
    .play-button {
      position: fixed;
      top: 2rem;
      right: 2rem;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      background-color: #000;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s ease, background-color 0.3s ease;
      z-index: 1000;
    }

    .play-button.on-orange {
      background-color: #ffffff;
    }

    .play-button:hover {
      transform: scale(1.1);
    }

    .play-button:active {
      transform: scale(0.95);
    }

    /* Play triangle */
    .play-button .play-icon {
      width: 0;
      height: 0;
      border-left: 18px solid #ffffff;
      border-top: 12px solid transparent;
      border-bottom: 12px solid transparent;
      margin-left: 4px;
    }

    .play-button.on-orange .play-icon {
      border-left-color: #000000;
    }

    /* Pause icon */
    .play-button .pause-icon {
      display: none;
      width: 20px;
      height: 24px;
      position: relative;
    }

    .play-button .pause-icon::before,
    .play-button .pause-icon::after {
      content: '';
      position: absolute;
      width: 6px;
      height: 24px;
      background-color: #ffffff;
    }

    .play-button.on-orange .pause-icon::before,
    .play-button.on-orange .pause-icon::after {
      background-color: #000000;
    }

    .play-button .pause-icon::before {
      left: 0;
    }

    .play-button .pause-icon::after {
      right: 0;
    }

    .play-button.playing .play-icon {
      display: none;
    }

    .play-button.playing .pause-icon {
      display: block;
    }
  </style>
</head>
<body>
  <!-- Play button -->
  <button class="play-button" id="playButton">
    <div class="play-icon"></div>
    <div class="pause-icon"></div>
  </button>

  <!-- Hidden YouTube player -->
  <div id="player" style="display: none;"></div>

  <!-- Fixed hero text -->
  <div class="hero">
    <div class="small-text" id="smallText">The fourth annual edition of</div>
    <h1 class="main-title" id="mainTitle">
      <span class="word"><span>t</span><span>h</span><span>e</span></span><span class="space"> </span><span class="word"><span>g</span><span>a</span><span>l</span><span>a</span></span>
    </h1>
  </div>

  <!-- White section - scrolls up to reveal orange -->
  <div class="white-section"></div>

  <!-- Orange section - fixed underneath -->
  <div class="orange-section">
    <div class="orange-blurb">
      From the windows, to the walls: it's time to drop the ball. We're gearing up for a fourth annual New Year's Gala, and would love to have you there
    </div>
  </div>

  <!-- Third orange screen - slides up to cover text -->
  <div class="third-section">
    <div class="third-content">
      <div class="third-left">
        <p>Join us for an evening of extraordinary performances and artistic expression. This year's gala brings together the most talented musicians, dancers, and visual artists from across the city. Experience the magic of live entertainment in an intimate setting designed to inspire and captivate. Our carefully curated program features both emerging talents and established performers. Each moment has been crafted to create an unforgettable experience. The venue transforms into a vibrant celebration of creativity and community. Discover new perspectives and connect with fellow art enthusiasts. This is more than an eventâ€”it's a journey into the heart of New York's creative spirit. Together we celebrate the power of the arts to unite and inspire. Be part of something truly special.</p>
      </div>
      <div class="third-right">
        <h2>Guest List</h2>
      </div>
    </div>
  </div>

  <!-- Scroll spacer to allow continued scrolling -->
  <div class="scroll-spacer"></div>

  <!-- Load YouTube IFrame API -->
  <script src="https://www.youtube.com/iframe_api"></script>

  <script>
    // YouTube Player for "Bad Decisions" by The Strokes
    let player;
    let isPlaying = false;

    function onYouTubeIframeAPIReady() {
      player = new YT.Player('player', {
        height: '0',
        width: '0',
        videoId: '5fbZTnZDvPA', // "Bad Decisions" by The Strokes (Official Audio)
        playerVars: {
          autoplay: 0,
          controls: 0,
          disablekb: 1,
          fs: 0,
          modestbranding: 1,
          playsinline: 1,
          enablejsapi: 1
        },
        events: {
          'onReady': onPlayerReady,
          'onStateChange': onPlayerStateChange,
          'onError': onPlayerError
        }
      });
    }

    function onPlayerError(event) {
      console.error('YouTube Player Error:', event.data);
      alert('Unable to play this song. Error code: ' + event.data);
    }

    function onPlayerReady(event) {
      // Player is ready
      document.getElementById('playButton').addEventListener('click', togglePlay);
    }

    function onPlayerStateChange(event) {
      // Update button state when video ends
      if (event.data === YT.PlayerState.ENDED) {
        isPlaying = false;
        document.getElementById('playButton').classList.remove('playing');
      }
    }

    function togglePlay() {
      if (!player || !player.playVideo) {
        console.error('Player not ready yet');
        return;
      }

      if (isPlaying) {
        player.pauseVideo();
        isPlaying = false;
        document.getElementById('playButton').classList.remove('playing');
        stopMusicSync(); // Stop text flicker when music pauses
      } else {
        // Optimistic UI update
        isPlaying = true;
        document.getElementById('playButton').classList.add('playing');
        startMusicSync(); // Start text flicker synced to beat
        
        // Mobile-optimized playback: Start muted, then unmute after play succeeds
        player.mute(); // Mute first to satisfy mobile autoplay policies
        
        const playPromise = player.playVideo();
        
        // Handle promise-based playback (modern browsers)
        if (playPromise !== undefined && playPromise.then) {
          playPromise.then(() => {
            // Play started successfully, now unmute
            player.unMute();
            player.setVolume(100);
            console.log('Playing video with audio...');
          }).catch((error) => {
            console.error('Play failed:', error);
            // Even if promise fails, try to unmute anyway
            player.unMute();
            player.setVolume(100);
          });
        } else {
          // Fallback for older browsers - unmute immediately
          player.unMute();
          player.setVolume(100);
        }
        
        console.log('Play initiated...');
      }
    }

    // Text flicker animation
    const title = document.getElementById('mainTitle');
    const letters = title.querySelectorAll('.word span');
    let isBold = true;
    let flickerInterval = null;
    let initialAnimationDone = false;
    
    // Initial burst animation on page load
    const burstPattern = [
      50, 50, 50, 150,
      50, 50, 50, 150,
      50, 50, 50, 150,
      50, 50, 50, 150,
      80, 80, 80, 250,
      80, 80, 80, 250,
      80, 80, 250,
      120, 120, 300,
      150, 150, 300,
      200, 300
    ];
    
    let currentIndex = 0;
    
    function flip() {
      isBold = !isBold;
      
      if (isBold) {
        letters.forEach(letter => letter.classList.remove('outline'));
      } else {
        letters.forEach(letter => letter.classList.add('outline'));
      }
    }
    
    function scheduleNextFlip() {
      if (currentIndex >= burstPattern.length) {
        letters.forEach(letter => letter.classList.remove('outline'));
        initialAnimationDone = true;
        isBold = true;
        return;
      }
      
      const delay = burstPattern[currentIndex];
      currentIndex++;
      
      setTimeout(function() {
        flip();
        scheduleNextFlip();
      }, delay);
    }
    
    // Start initial animation on page load
    scheduleNextFlip();
    
    // Beat map for "Bad Decisions" - exact timestamps in seconds
    const beatMap = [
      // Intro (sparse beats)
      0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5,
      // Build-up
      4.0, 4.5, 5.0, 5.5, 6.0, 6.5, 7.0, 7.5,
      // Verse 1 (110 BPM = 0.545s per beat)
      8.0, 8.55, 9.1, 9.65, 10.2, 10.75, 11.3, 11.85,
      12.4, 12.95, 13.5, 14.05, 14.6, 15.15, 15.7, 16.25,
      16.8, 17.35, 17.9, 18.45, 19.0, 19.55, 20.1, 20.65,
      21.2, 21.75, 22.3, 22.85, 23.4, 23.95, 24.5, 25.05,
      // Pre-chorus
      25.6, 26.15, 26.7, 27.25, 27.8, 28.35, 28.9, 29.45,
      30.0, 30.55, 31.1, 31.65, 32.2, 32.75, 33.3, 33.85,
      // Chorus (emphasized beats)
      34.4, 35.5, 36.6, 37.7, 38.8, 39.9, 41.0, 42.1,
      43.2, 44.3, 45.4, 46.5, 47.6, 48.7, 49.8,
      // Verse 2
      50.9, 51.45, 52.0, 52.55, 53.1, 53.65, 54.2, 54.75,
      55.3, 55.85, 56.4, 56.95, 57.5, 58.05, 58.6, 59.15,
      59.7, 60.25, 60.8, 61.35, 61.9, 62.45, 63.0, 63.55,
      64.1, 64.65, 65.2, 65.75, 66.3, 66.85, 67.4, 67.95,
      // Chorus 2
      68.5, 69.6, 70.7, 71.8, 72.9, 74.0, 75.1, 76.2,
      77.3, 78.4, 79.5, 80.6, 81.7, 82.8, 83.9,
      // Bridge/Guitar solo
      85.0, 85.55, 86.1, 86.65, 87.2, 87.75, 88.3, 88.85,
      89.4, 89.95, 90.5, 91.05, 91.6, 92.15, 92.7, 93.25,
      93.8, 94.35, 94.9, 95.45, 96.0, 96.55, 97.1, 97.65,
      98.2, 98.75, 99.3, 99.85, 100.4, 100.95, 101.5, 102.05,
      // Final chorus
      102.6, 103.7, 104.8, 105.9, 107.0, 108.1, 109.2, 110.3,
      111.4, 112.5, 113.6, 114.7, 115.8, 116.9, 118.0,
      // Outro
      119.1, 120.2, 121.3, 122.4, 123.5, 124.6, 125.7, 126.8,
      127.9, 129.0, 130.1, 131.2, 132.3, 133.4, 134.5
    ];
    
    let beatCheckInterval = null;
    let lastBeatIndex = -1;
    
    // Music-synced flicker (triggered when music plays)
    function startMusicSync() {
      if (beatCheckInterval) return; // Already running
      
      // Check playback time 60 times per second
      beatCheckInterval = setInterval(function() {
        if (!player || !player.getCurrentTime) return;
        
        const currentTime = player.getCurrentTime();
        
        // Find the next beat that should trigger
        for (let i = lastBeatIndex + 1; i < beatMap.length; i++) {
          if (currentTime >= beatMap[i] && currentTime < beatMap[i] + 0.1) {
            // We hit a beat!
            flip();
            lastBeatIndex = i;
            break;
          }
        }
        
        // Reset if we've looped or restarted
        if (currentTime < 1.0) {
          lastBeatIndex = -1;
        }
      }, 16); // ~60fps
    }
    
    function stopMusicSync() {
      if (beatCheckInterval) {
        clearInterval(beatCheckInterval);
        beatCheckInterval = null;
        lastBeatIndex = -1;
        // Reset to bold
        isBold = true;
        letters.forEach(letter => letter.classList.remove('outline'));
      }
    }

    // Scroll-based color change and third section slide-up
    const playButton = document.getElementById('playButton');
    const smallText = document.getElementById('smallText');
    const mainTitle = document.getElementById('mainTitle');
    const orangeBlurb = document.querySelector('.orange-blurb');
    const thirdSection = document.querySelector('.third-section');

    window.addEventListener('scroll', function() {
      const scrollY = window.scrollY;
      const viewportHeight = window.innerHeight;
      
      // When scroll passes the viewport height, we're into the orange section
      if (scrollY >= viewportHeight) {
        playButton.classList.add('on-orange');
        smallText.classList.add('on-orange');
        mainTitle.classList.add('on-orange');
        orangeBlurb.classList.add('on-orange');
      } else {
        playButton.classList.remove('on-orange');
        smallText.classList.remove('on-orange');
        mainTitle.classList.remove('on-orange');
        orangeBlurb.classList.remove('on-orange');
      }

      // Smoothly slide up third section based on scroll progress
      // Start sliding when scroll reaches 2x viewport, complete by 3x viewport
      const slideStart = viewportHeight * 2;
      const slideEnd = viewportHeight * 3;
      
      if (scrollY >= slideEnd) {
        // Fully visible
        thirdSection.style.transform = 'translateY(0)';
      } else if (scrollY >= slideStart) {
        // Gradually slide up based on scroll progress
        const progress = (scrollY - slideStart) / (slideEnd - slideStart);
        const translateY = 100 - (progress * 100);
        thirdSection.style.transform = `translateY(${translateY}%)`;
      } else {
        // Hidden below viewport
        thirdSection.style.transform = 'translateY(100%)';
      }
    });
  </script>
</body>
</html>

